<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI é€²éšç‡Ÿé¤Šå¸« | ä¸‰å¤§ç‡Ÿé¤Šç´ ç›£æ§</title>
    <style>
        :root { --primary: #27ae60; --secondary: #2980b9; --warn: #e67e22; --danger: #c0392b; --bg: #f0f2f5; }
        body { font-family: 'PingFang TC', sans-serif; background: var(--bg); margin: 0; display: flex; justify-content: center; height: 100vh; }
        .app-container { width: 100%; max-width: 1200px; display: flex; gap: 15px; margin: 20px; border-radius: 15px; overflow: hidden; }
        
        /* å´é‚Šè³‡è¨Šæ¬„ */
        .sidebar { width: 350px; background: white; padding: 20px; display: flex; flex-direction: column; gap: 15px; box-shadow: 2px 0 10px rgba(0,0,0,0.05); overflow-y: auto; }
        .info-card { background: #f9f9f9; padding: 15px; border-radius: 10px; border-top: 4px solid var(--secondary); }
        .info-card h3 { margin: 0 0 10px 0; font-size: 1rem; color: #333; }
        .input-group { margin-bottom: 10px; }
        label { font-size: 0.8rem; color: #666; }
        input[type="number"], select { width: 90%; padding: 8px; margin-top: 5px; border: 1px solid #ddd; border-radius: 5px; }
        
        /* æ•¸å€¼é¢æ¿ */
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .stat-item { background: #fff; padding: 10px; border-radius: 8px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .stat-label { font-size: 0.75rem; color: #888; }
        .stat-val { font-size: 1.1rem; font-weight: bold; color: var(--secondary); }

        /* èŠå¤©ä¸»å€ */
        .chat-section { flex: 1; background: #e5ddd5; display: flex; flex-direction: column; }
        .chat-header { background: var(--primary); color: white; padding: 15px 20px; font-weight: bold; }
        
        /* ç‡Ÿé¤Šé ç®—åˆ— */
        .macro-bar { background: white; padding: 15px; display: flex; justify-content: space-around; border-bottom: 1px solid #ddd; text-align: center; }
        .macro-item { flex: 1; }
        .macro-name { font-size: 0.7rem; color: #666; }
        .macro-remain { font-size: 1rem; font-weight: bold; }
        .remain-cal { color: var(--danger); font-size: 1.2rem; }

        .chat-window { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .msg { max-width: 75%; padding: 12px; border-radius: 10px; font-size: 0.95rem; line-height: 1.5; }
        .user-msg { align-self: flex-end; background: #dcf8c6; }
        .ai-msg { align-self: flex-start; background: white; }
        .input-area { padding: 15px; background: #f0f0f0; display: flex; gap: 10px; }
        .input-area input { flex: 1; border: none; padding: 12px; border-radius: 20px; outline: none; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="sidebar">
        <div class="info-card">
            <h3>ğŸ‘¤ å€‹äººé«”æ…‹è¨­å®š</h3>
            <div class="input-group"><label>èº«é«˜ (cm)</label><input type="number" id="height" value="170" oninput="calculatePlan()"></div>
            <div class="input-group"><label>ç›®å‰é«”é‡ (kg)</label><input type="number" id="weight" value="70" oninput="calculatePlan()"></div>
            <div class="input-group"><label>ç›®æ¨™é«”é‡ (kg)</label><input type="number" id="targetWeight" value="65" oninput="calculatePlan()"></div>
            <div class="stat-grid">
                <div class="stat-item"><div class="stat-label">ç›®å‰ BMI</div><div class="stat-val" id="bmiVal">--</div></div>
                <div class="stat-item"><div class="stat-label">æ¯æ—¥å»ºè­°ç†±é‡</div><div class="stat-val" id="suggestedCal">--</div></div>
            </div>
        </div>
        <div class="info-card">
            <h3>ğŸ“Š ç‡Ÿé¤Šç´ ç›®æ¨™ (g)</h3>
            <div class="stat-grid">
                <div class="stat-item"><div class="stat-label">è›‹ç™½è³ª</div><div class="stat-val" style="color: #e67e22" id="goalP">--</div></div>
                <div class="stat-item"><div class="stat-label">ç¢³æ°´</div><div class="stat-val" style="color: #2980b9" id="goalC">--</div></div>
                <div class="stat-item"><div class="stat-label">è„‚è‚ª</div><div class="stat-val" style="color: #f1c40f" id="goalF">--</div></div>
            </div>
        </div>
    </div>

    <div class="chat-section">
        <div class="chat-header">ğŸ AI ç‡Ÿé¤Šå¸«ï¼šæ¯æ—¥é£²é£Ÿç›£ç£</div>
        <div class="macro-bar">
            <div class="macro-item"><div class="macro-name">å‰©é¤˜ç†±é‡</div><div class="macro-remain remain-cal" id="remCal">--</div></div>
            <div class="macro-item"><div class="macro-name">å‰©é¤˜è›‹ç™½(g)</div><div class="macro-remain" id="remP">--</div></div>
            <div class="macro-item"><div class="macro-name">å‰©é¤˜ç¢³æ°´(g)</div><div class="macro-remain" id="remC">--</div></div>
            <div class="macro-item"><div class="macro-name">å‰©é¤˜è„‚è‚ª(g)</div><div class="macro-remain" id="remF">--</div></div>
        </div>
        <div class="chat-window" id="chatWindow">
            <div class="msg ai-msg">è¨­å®šå¥½å·¦å´è³‡æ–™å¾Œï¼Œè«‹è¼¸å…¥ä½ å‰›æ‰åƒäº†ä»€éº¼ï¼Ÿæˆ‘æœƒè‡ªå‹•ä¼°ç®—ä¸¦æ‰£é™¤é¡åº¦ã€‚</div>
        </div>
        <div class="input-area">
            <input type="text" id="userInput" placeholder="ä¾‹å¦‚ï¼šåˆé¤åƒé›èƒ¸è‚‰ã€è›‹ç™½é£²ã€ä¸€å€‹åœ°ç“œ" onkeypress="if(event.keyCode==13) sendMessage()">
            <button onclick="sendMessage()" style="background:var(--primary); color:white; border:none; border-radius:20px; padding:0 20px; cursor:pointer;">ç´€éŒ„</button>
        </div>
    </div>
</div>

<script>
    let currentData = { cal: 0, p: 0, c: 0, f: 0 };
    let goals = { cal: 0, p: 0, c: 0, f: 0 };

    function calculatePlan() {
        const h = document.getElementById('height').value / 100;
        const w = document.getElementById('weight').value;
        const tw = document.getElementById('targetWeight').value;
        
        if (h > 0 && w > 0) {
            const bmi = (w / (h * h)).toFixed(1);
            document.getElementById('bmiVal').innerText = bmi;

            // æ¸›è„‚å»ºè­°ç†±é‡ä¼°ç®—ï¼šé«”é‡ * 25 (ä½å¼·åº¦æ¸›è„‚)
            goals.cal = Math.round(w * 25);
            // è›‹ç™½è³ªè¨­å®šï¼šé«”é‡ * 1.8g
            goals.p = Math.round(w * 1.8);
            // è„‚è‚ªè¨­å®šï¼šç¸½ç†±é‡ 25% (1g è„‚è‚ª = 9kcal)
            goals.f = Math.round((goals.cal * 0.25) / 9);
            // ç¢³æ°´è¨­å®šï¼šå‰©ä¸‹ç†±é‡ (1g ç¢³æ°´/è›‹ç™½ = 4kcal)
            goals.c = Math.round((goals.cal - (goals.p * 4) - (goals.f * 9)) / 4);

            updateDisplay();
        }
    }

    // é£Ÿç‰©è³‡æ–™åº«ï¼š[ç†±é‡, è›‹ç™½è³ª, ç¢³æ°´, è„‚è‚ª]
    const foodDb = {
        "é›èƒ¸è‚‰": [165, 31, 0, 3],
        "è›‹ç™½é£²": [120, 25, 3, 1],
        "åœ°ç“œ": [120, 1, 28, 0],
        "è›‹": [75, 7, 1, 5],
        "ä¾¿ç•¶": [750, 30, 80, 35],
        "æ²™æ‹‰": [100, 2, 10, 5],
        "ç™½é£¯": [200, 4, 45, 0],
        "ç„¡ç³–è±†æ¼¿": [100, 10, 5, 4]
    };

    function sendMessage() {
        const input = document.getElementById('userInput');
        const text = input.value;
        if (!text) return;

        addMessage(text, 'user-msg');

        let feedback = "æ”¶åˆ°ç´€éŒ„ï¼";
        let found = false;

        for (let food in foodDb) {
            if (text.includes(food)) {
                currentData.cal += foodDb[food][0];
                currentData.p += foodDb[food][1];
                currentData.c += foodDb[food][2];
                currentData.f += foodDb[food][3];
                feedback = `åµæ¸¬åˆ°ã€Œ${food}ã€ï¼Œå·²ç‚ºæ‚¨æ‰£é™¤ç‡Ÿé¤Šé¡åº¦ã€‚`;
                found = true;
                break;
            }
        }

        if(!found) {
            currentData.cal += 300; // é è¨­å€¼
            feedback = "ç„¡æ³•ç²¾ç¢ºè¾¨è­˜é£Ÿç‰©ï¼Œå·²é æ‰£ 300 å¤§å¡ã€‚";
        }

        setTimeout(() => {
            addMessage(feedback, 'ai-msg');
            updateDisplay();
        }, 500);

        input.value = "";
    }

    function updateDisplay() {
        document.getElementById('suggestedCal').innerText = goals.cal;
        document.getElementById('goalP').innerText = goals.p;
        document.getElementById('goalC').innerText = goals.c;
        document.getElementById('goalF').innerText = goals.f;

        document.getElementById('remCal').innerText = goals.cal - currentData.cal;
        document.getElementById('remP').innerText = goals.p - currentData.p;
        document.getElementById('remC').innerText = goals.c - currentData.c;
        document.getElementById('remF').innerText = goals.f - currentData.f;
    }

    function addMessage(text, className) {
        const window = document.getElementById('chatWindow');
        const div = document.createElement('div');
        div.className = 'msg ' + className;
        div.innerText = text;
        window.appendChild(div);
        window.scrollTop = window.scrollHeight;
    }

    // åˆå§‹åŸ·è¡Œä¸€æ¬¡
    calculatePlan();
</script>

</body>
</html>
